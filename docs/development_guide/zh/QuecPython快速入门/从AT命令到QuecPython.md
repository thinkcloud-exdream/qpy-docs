# 从 AT 到 QuecPython

## 关于模块

无线通信模块（模组）是实现数据上云和远程通信的必不可少的组件，在各类物联网场景中已经得到了极为广泛的应用。其本质可理解为一种将主芯片、无线基带、存储器、功放等器件集成在一起，用于完成本地电路与云端服务的数据通信功能的高密度、小体积、带屏蔽罩的“核心板”。

就像电脑插上网卡就可以上网一样，在嵌入式系统中加入了模块，系统就具有了连接无线网络的可能性。

![](E:\QuecPython网站搬移\V1\teedoc_with_qpydoc\docs\development_guide\zh\media\QuecPython快速入门\快速入门_AT_1.jpg)

​																								EC200A_TE-A_EVB板

## 模块的标准开发方式

在大部分应用场景中，本地电路上的主处理器（主控）通过特定的接口（通常为串口）与模块建立连接，发送特定的指令（AT 指令）控制模块实现包括数据上传、无线通话、设备定位等在内的一系列功能。这种工作方式通常称为标准模式或传统模式，是当前应用最普遍、历史最悠久的模块使用方式。

![](E:\QuecPython网站搬移\V1\teedoc_with_qpydoc\docs\development_guide\zh\media\QuecPython快速入门\快速入门_AT_2.png)

如上图所示，在标准模式中，通信模块是作为主控（MCU，如 STM32）的一个外设的角色而存在的。两者之间通过 UART 串口相连接，基于 AT 指令进行双向交互。系统的主要业务逻辑（用户应用，APP）在 MCU 中运行，其他外设通过 UART、I2C 等接口与 MCU 相连，受 MCU 控制。

在标准模式下，主控中运行的用户 APP 需要包含较为复杂的 AT 指令发送和解析功能，例如对于 URC（Unsolicited Result Code，非请求结果码）的处理等。对于新手而言，整体开发难度较大。

## 模块的 OpenCPU 开发方式

模块所搭载的主芯片为了满足无线通信的需要，通常具有较高的性能和较多的资源，同时也配备了包括 GPIO、ADC、I2C 等在内的丰富的外设接口，运行着较为完备的操作系统（RTOS 或 Linux），因而在一定程度上具备了取代传统模式中的主控的能力。部分厂家会开放模块内部的软硬件资源供用户使用。这种使用模块作为主处理器，对模块进行二次开发的应用模式常被称为 OpenCPU（不同厂家可能有不同的称呼，如移远的 QuecOpen、芯讯通的 OpenLinux 等）。

![](E:\QuecPython网站搬移\V1\teedoc_with_qpydoc\docs\development_guide\zh\media\QuecPython快速入门\快速入门_AT_3.png)

如图所示，与标准模式相比，OpenCPU 模式由于将模块本身作为主控使用，用户应用（APP）直接置于模块内部运行，整个系统中无需外部处理器（MCU），因而可以有效地达到精简硬件设计、降低器件成本、缩小产品尺寸的目的。在单片机价格居高不下的当下，OpenCPU 方案受到了众多公司的青睐。

但是，OpenCPU 方案也具有较为明显的局限性。由于这一模式通常需要用户直接在模块底层运行的操作系统的基础上进行开发，技术门槛较高，传统的、不具备系统级开发经验的单片机开发者很难适应。其次，由于 OpenCPU 技术支持难度大，模块厂家通常只向大客户提供相关的工具和资料，入门较为不便。最后，不同厂家、不同型号的模块，其 OpenCPU 开发环境和开发工具存在较大差别，用户编写的程序在不同模块间的移植存在一定的难度。

## 使用脚本语言开发模块

传统的 OpenCPU 开发通常使用 C 语言，因此也被称作 CSDK 开发。用户需要直接修改和控制底层的操作系统，具有较高的难度和一定的风险性。部分模块厂商通过在 CSDK 的基础上移植解释器 / 虚拟机的方式，使得用户可以使用 Lua、Python 等脚本语言对模块进行开发。

与 C 语言相比，脚本语言在语法和使用方式上普遍较为简单，开发者无需花费太多时间和精力即可掌握，并可相对轻松地实现业务逻辑，便于项目的快速开发和功能迭代。同时，在使用脚本语言进行开发时，开发者通常也无需考虑内存回收、基础任务调度等底层细节，显著降低了模块二次开发的技术门槛。最后，对于不同型号的模块，只要它们运行的是同一种脚本语言解释器，用户编写的程序通常只需少量修改（甚至无需修改）即可完成移植。

## 关于 QuecPython

Python 是一种热门的解释型脚本语言。因其语法简单、功能丰富的特点，被广泛应用于服务器、数据库、图像处理、人工智能等领域。MicroPython 是 Python 语言的精简高效实现。它基本兼容 Python 3.4 版本的语法特性，同时进行了针对性优化，使其能够在微控制器和其他资源受限的环境中运行。目前，MicroPython 已经支持包括 STM32、ESP32、RP2040 在内的多种硬件平台。

移远将 MicroPython 移植到了多款 4G 和 NB-IoT 模块上，并增加了大量与无线通信相关的功能库，称之为 QuecPython。由此，用户可以使用 MicroPython 脚本对移远通信模块进行快速便捷的二次开发。

目前，QuecPython 方案已经在智能家电、工业控制、智慧交通等场景得到应用。各类公司基于 QuecPython 方案推出的产品包括车载定位器、DTU、4G 对讲机等数十种。
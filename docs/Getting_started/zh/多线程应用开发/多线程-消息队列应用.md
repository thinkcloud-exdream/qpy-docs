# 多线程-消息队列
## 什么是多线程-消息队列

本文介绍如何使用QuecPython的多线程-消息队列功能，消息队列用于线程间通信，如A是中断回调线程接收数据，B是普通线程处理数据，A线程把接收到的数据通过Queue发送到B线程后立即结束A线程，从而减少A线程占用CPU的时间。

## 怎么使用多线程-消息队列

### 软件应用

使用QuecPython开发的模组，调用queue模块中的queue.Queue()可以创建消息队列，具体参数参考[queue功能的API介绍文档](/../../API_reference/zh/QuecPython标准库/Queue - 普通队列.html)，获取队列数据时，若队列有数据则立即返回，否则进入阻塞并切换上下文，直到队列有数据才继续往下执行。

```python
import _thread
from queue import Queue
import utime

# 初始化队列
q = Queue(maxsize=100)

def thread_get():
    while True:
        # q.get 会阻塞等待消息过来，每当有q.put()执行完后 q.get()会收到数据，解除阻塞往下执行
        item = q.get()
        print("q.get:", item)

# 开启线程在哪等待消息
_thread.start_new_thread(thread_get, ())
# put消息到队列
q.put(1)
utime.sleep(1)
q.put() # 空数据默认 None
utime.sleep(1)
q.put(None) # 空数据默认 None
utime.sleep(1)
q.put(3)
```


## queue功能测试

使用QPYcom工具执行代码，可以看出每当q.put()数据后，等待消息的线程立即执行打印数据。

![](../media\多线程应用开发/_thread-Queue.png)

